# Работа с Сервером

Работа с сервером происходит с помощью библиотек retrofit2, okhttp, gson, rxjava.

Для работы с сетью предусмотрены модули:
 * [network](../../network/README.md)
 * [Gson-конвертер](../../converter-gson/README.md)

При работе с сервером возникает необхдимость добавлять те или иные параметры
в запрос. Для этих целей хорошо подходит сущности типа `Interceptor`. Такие
сущности передаются в билдер OkHttp-клента.

Также удобно [логгировать][log] ответы сервера, а также ошибки парсинга на удаленный сервер
с целью быстрого нахождения ошибок. **Не следует логгировать пользовательские
данные**.

Если на сервере существует механизм ошибок, когда не с 200-м кодом
приходит еще и тело ошибки, то такие сообщения следует приводить к специфичному
исключению. Эти операции следует производить на уровне [`CallAdapter`'а][call]

Ошибки парсинга Json (JsonSyntaxException) следует конвертировать в служебную
ошибку. Этим занимается [`Converter`][gson].


### Открытие экранов по спец ошибкам

В случае если возникает необходимость открыть экран прямо из слоя Interactor,
например, когда у пользователя устарел токен и необходимо перекинуть его на экран
авторизации, необходимо использовать глобальный навигатор, поставляемый модулем
[core-ui](../../core-ui/README.md).
Это необходимо,  чтобы не тащить данную логику на ui.

### Кеширование данных

//Зачем, способы , плюсы минусы.
- простой кеш (Url-кеш)
- объектное хранилище
- база данных

[TODO]: ../расписать_подробно

###### Гибридные запросы

### Обработка ошибок на UI

### Маппинг ответов сервера

### Тесты API



[log]: ../common/logging.md
[gson]: ../../converter-gson/README.md
[call]: ../../network/README.md
